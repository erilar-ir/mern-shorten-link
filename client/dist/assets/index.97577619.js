var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(t,l,n)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[l]=n,c=(e,t)=>{for(var l in t||(t={}))a.call(t,l)&&s(e,l,t[l]);if(n)for(var l of n(t))r.call(t,l)&&s(e,l,t[l]);return e};import{r as o,R as i,L as m,u,a as d,S as E,b as p,c as g,N as h,B as k,d as f}from"./vendor.cef26e7b.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const l of e)if("childList"===l.type)for(const e of l.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();function v(){}const y=o.exports.createContext({token:null,userId:null,login:v,logout:v,isAuthenticated:!1}),b=()=>{const[e,t]=o.exports.useState(!1),[l,n]=o.exports.useState(null);return{loading:e,error:l,request:o.exports.useCallback((async(e,l="GET",a=null,r={})=>{t(!0);try{a&&(a=JSON.stringify(a),r["Content-Type"]="application/json");const n=await fetch(e,{method:l,body:a,headers:r}),s=await n.json();if(!n.ok)throw new Error(s.message||"Something went wrong");return t(!1),s}catch(s){throw t(!1),n(s.message),s}}),[]),clearError:o.exports.useCallback((()=>{n(null)}),[])}},N=()=>o.exports.useCallback((e=>{window.M&&e&&window.M.toast({html:e})}),[]);const x=()=>i.createElement("div",{className:"loader"},i.createElement("div",{className:"preloader-wrapper active"},i.createElement("div",{className:"spinner-layer spinner-red-only"},i.createElement("div",{className:"circle-clipper left"},i.createElement("div",{className:"circle"})),i.createElement("div",{className:"gap-patch"},i.createElement("div",{className:"circle"})),i.createElement("div",{className:"circle-clipper right"},i.createElement("div",{className:"circle"})))));const w=({links:e})=>0===e.length?i.createElement("div",{className:"links-list"},i.createElement("div",{className:"no-links"},i.createElement("p",null," There is no links yet"))):i.createElement("div",{className:"links-list"},i.createElement("table",null,i.createElement("thead",null,i.createElement("tr",null,i.createElement("th",null,"#"),i.createElement("th",null,"Destination"),i.createElement("th",null,"Short link"),i.createElement("th",null,"Clicks"),i.createElement("th",null,"Details"))),i.createElement("tbody",null,e.map(((e,t)=>{const{to:l,from:n,_id:a,clicks:r}=e;return i.createElement("tr",{key:a},i.createElement("td",null,t+1),i.createElement("td",null,n),i.createElement("td",null,l),i.createElement("td",null,r),i.createElement("td",null,i.createElement(m,{to:`/details/${a}`},i.createElement("i",{className:"material-icons"},"search"))))}))))),S=()=>{const{token:e}=o.exports.useContext(y),{loading:t,request:l}=b(),[n,a]=o.exports.useState([]),r=o.exports.useCallback((async()=>{try{const t=await l("/api/link","GET",null,{Authorization:`Bearer ${e}`});a(t),console.log(t)}catch(t){console.log(t)}}),[e,l]);return o.exports.useEffect((()=>{r()}),[r]),t?i.createElement(x,null):i.createElement(i.Fragment,null,!t&&i.createElement(w,{links:n}))};const C=()=>{const{token:e}=o.exports.useContext(y),{request:t}=b(),l=u(),[n,a]=o.exports.useState(""),r=async()=>{try{const a=await t("/api/link/generate","POST",{from:n},{Authorization:`Bearer ${e}`});l.push(`/details/${a.link._id}`),console.log(a)}catch(a){}};return i.createElement("div",{className:"create-page"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col s8 offset-s2"},i.createElement("div",{className:"input-field"},i.createElement("input",{type:"text",id:"link",value:n,onChange:e=>{a(e.target.value)},onKeyPress:e=>{"Enter"===e.key&&r()}}),i.createElement("label",{htmlFor:"{'email'}"},"Enter link")),i.createElement("div",{className:"buttons"},i.createElement("button",{className:"btn teal lighten-2",onClick:r},"Generate Link")))))};const O=({link:e,removeLink:t})=>{const{to:l,from:n,clicks:a,date:r}=e;return i.createElement("div",{className:"link-card"},i.createElement("h2",null,"Link info"),i.createElement("p",null,"Short link: ",i.createElement("a",{href:l,target:"_blank",rel:"noreferrer noopener"},l)),i.createElement("p",null,"Destination link: ",i.createElement("a",{href:n,target:"_blank",rel:"noreferrer noopener"},n)),i.createElement("p",null,"Link clicks: ",i.createElement("strong",null,a)),i.createElement("p",null,"Create date: ",i.createElement("strong",null,new Date(+r).toLocaleDateString())),i.createElement("button",{className:"btn red lighten-1",onClick:t},"Remove link"))},I=()=>{const{token:e}=o.exports.useContext(y),{request:t,loading:l}=b(),[n,a]=o.exports.useState(null),r=u(),s=d().id,c=N(),m=o.exports.useCallback((async()=>{try{await t(`/api/link/${s}`,"GET",null,{Authorization:`Bearer ${e}`}).then((e=>{a(e)}))}catch(l){console.log(l)}}),[e,t,s]),E=o.exports.useCallback((async()=>{try{await t(`/api/link/remove/${s}`,"POST",null,{Authorization:`Bearer ${e}`}).then((e=>{r.push("/links"),c(e.message)}))}catch(l){console.log(l)}}),[e,t,s]);return o.exports.useEffect((()=>{m()}),[m]),l?i.createElement(x,null):i.createElement(i.Fragment,null,!l&&n&&i.createElement(O,{link:n,removeLink:E}))};const L=()=>{const e=o.exports.useContext(y),{loading:n,error:a,request:r,clearError:s}=b(),[m,u]=o.exports.useState({email:"",password:""}),d=N();o.exports.useEffect((()=>{d(a),s()}),[a,d,s]);const E=e=>{var n,a;u((n=c({},m),a={[e.target.name]:e.target.value},t(n,l(a))))};return i.createElement("div",{className:"auth-page"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col s6 offset-s3"},i.createElement("h1",null,"Shorten the link"),i.createElement("div",{className:"card grey lighten-5"},i.createElement("div",{className:"card-content black-text"},i.createElement("span",{className:"card-title"},"Authorization"),i.createElement("div",{className:"auth-form-fields"},i.createElement("div",{className:"input-field"},i.createElement("input",{type:"text",id:"email",name:"email",onChange:E,value:m.email}),i.createElement("label",{htmlFor:"{'email'}"},"Email")),i.createElement("div",{className:"input-field"},i.createElement("input",{type:"password",id:"password",name:"password",onChange:E,value:m.password}),i.createElement("label",{htmlFor:"{'password'}"},"Password")))),i.createElement("div",{className:"card-action buttons"},i.createElement("button",{className:"btn yellow darken-4",onClick:async()=>{try{const t=await r("/api/auth/login","POST",c({},m));e.login(t.token,t.userId)}catch(t){}},disabled:n},"Sign In"),i.createElement("button",{className:"btn teal lighten-1 ",onClick:async()=>{try{const e=await r("/api/auth/register","POST",c({},m));d(e.message)}catch(e){}},disabled:n},"Sign Up"))))))};const P=()=>{const e=u(),{logout:t}=o.exports.useContext(y);return i.createElement("nav",null,i.createElement("div",{className:"nav-wrapper header teal lighten-1"},i.createElement("span",{className:"brand-logo"},"Shorten Link"),i.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},i.createElement("li",null,i.createElement(h,{to:"/create"},"Create")),i.createElement("li",null,i.createElement(h,{to:"/links"},"Links")),i.createElement("li",null,i.createElement("a",{href:"/",onClick:l=>{l.preventDefault(),t(),e.push("/")}},"Logout")))))};function D(){const{token:e,userId:t,login:l,logout:n,ready:a}=(()=>{const[e,t]=o.exports.useState(null),[l,n]=o.exports.useState(null),[a,r]=o.exports.useState(!1),s=o.exports.useCallback(((e,l)=>{t(e),n(l),localStorage.setItem("userData",JSON.stringify({userId:l,token:e}))}),[]),c=o.exports.useCallback((()=>{t(null),n(null),localStorage.removeItem("userData")}),[]);return o.exports.useEffect((()=>{const e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&s(e.token,e.userId),r(!0)}),[s]),{login:s,logout:c,token:e,userId:l,ready:a}})(),r=!!e,s=(e=>e?i.createElement(E,null,i.createElement(p,{path:"/links",exact:!0},i.createElement(S,null)),i.createElement(p,{path:"/create",exact:!0},i.createElement(C,null)),i.createElement(p,{path:"/details/:id"},i.createElement(I,null)),i.createElement(g,{to:"/create"})):i.createElement(E,null,i.createElement(p,{path:"/",exact:!0},i.createElement(L,null)),i.createElement(g,{to:"/"})))(r);return a?i.createElement(y.Provider,{value:{token:e,userId:t,login:l,logout:n,isAuthenticated:r}},i.createElement(k,null,r&&i.createElement(P,null),i.createElement("div",{className:"container"},s))):i.createElement(x,null)}f.render(i.createElement(i.StrictMode,null,i.createElement(D,null)),document.getElementById("root"));
