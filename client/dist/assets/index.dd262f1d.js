var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(t,l,a)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,c=(e,t)=>{for(var l in t||(t={}))n.call(t,l)&&s(e,l,t[l]);if(a)for(var l of a(t))r.call(t,l)&&s(e,l,t[l]);return e};import{r as o,R as i,L as m,u,a as d,S as E,b as p,c as g,N as h,B as k,d as f}from"./vendor.cef26e7b.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const l of e)if("childList"===l.type)for(const e of l.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();function v(){}const y=o.exports.createContext({token:null,userId:null,login:v,logout:v,isAuthenticated:!1}),b=()=>{const[e,t]=o.exports.useState(!1),[l,a]=o.exports.useState(null);return{loading:e,error:l,request:o.exports.useCallback((async(e,l="GET",n=null,r={})=>{t(!0);try{n&&(n=JSON.stringify(n),r["Content-Type"]="application/json");const a=await fetch(e,{method:l,body:n,headers:r}),s=await a.json();if(!a.ok)throw new Error(s.message||"Something went wrong");return t(!1),s}catch(s){throw t(!1),a(s.message),s}}),[]),clearError:o.exports.useCallback((()=>{a(null)}),[])}};const N=()=>i.createElement("div",{className:"loader"},i.createElement("div",{className:"preloader-wrapper active"},i.createElement("div",{className:"spinner-layer spinner-red-only"},i.createElement("div",{className:"circle-clipper left"},i.createElement("div",{className:"circle"})),i.createElement("div",{className:"gap-patch"},i.createElement("div",{className:"circle"})),i.createElement("div",{className:"circle-clipper right"},i.createElement("div",{className:"circle"})))));const x=({links:e})=>0===e.length?i.createElement("div",{className:"links-list"},i.createElement("div",{className:"no-links"},i.createElement("p",null," There is no links yet"))):i.createElement("div",{className:"links-list"},i.createElement("table",null,i.createElement("thead",null,i.createElement("tr",null,i.createElement("th",null,"#"),i.createElement("th",null,"Destination"),i.createElement("th",null,"Short link"),i.createElement("th",null,"Clicks"),i.createElement("th",null,"Details"))),i.createElement("tbody",null,e.map(((e,t)=>{const{to:l,from:a,_id:n,clicks:r}=e;return i.createElement("tr",{key:n},i.createElement("td",null,t+1),i.createElement("td",null,a),i.createElement("td",null,l),i.createElement("td",null,r),i.createElement("td",null,i.createElement(m,{to:`/details/${n}`},i.createElement("i",{className:"material-icons"},"search"))))}))))),w=()=>{const{token:e,userId:t}=o.exports.useContext(y),{loading:l,request:a}=b(),[n,r]=o.exports.useState([]),s=o.exports.useCallback((async()=>{try{const t=await a("/api/link","GET",null,{Authorization:`Bearer ${e}`});r(t),console.log(t)}catch(t){console.log(t)}}),[e,a]);return o.exports.useEffect((()=>{s()}),[s]),l?i.createElement(N,null):i.createElement(i.Fragment,null,!l&&i.createElement(x,{links:n}))};const S=()=>{const{token:e}=o.exports.useContext(y),{request:t}=b(),l=u(),[a,n]=o.exports.useState(""),r=async()=>{try{const n=await t("/api/link/generate","POST",{from:a},{Authorization:`Bearer ${e}`});l.push(`/details/${n.link._id}`),console.log(n)}catch(n){}};return i.createElement("div",{className:"create-page"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col s8 offset-s2"},i.createElement("div",{className:"input-field"},i.createElement("input",{type:"text",id:"link",value:a,onChange:e=>{n(e.target.value)},onKeyPress:e=>{"Enter"===e.key&&r()}}),i.createElement("label",{htmlFor:"{'email'}"},"Enter link")),i.createElement("div",{className:"buttons"},i.createElement("button",{className:"btn teal lighten-2",onClick:r},"Generate Link")))))};const C=({link:e})=>{const{to:t,from:l,clicks:a,date:n}=e;return i.createElement("div",{className:"link-card"},i.createElement("h2",null,"Link info"),i.createElement("p",null,"Short link: ",i.createElement("a",{href:t,target:"_blank",rel:"noreferrer noopener"},t)),i.createElement("p",null,"Destination link: ",i.createElement("a",{href:l,target:"_blank",rel:"noreferrer noopener"},l)),i.createElement("p",null,"Link clicks: ",i.createElement("strong",null,a)),i.createElement("p",null,"Create date: ",i.createElement("strong",null,new Date(+n).toLocaleDateString())))},O=()=>{const{token:e}=o.exports.useContext(y),{request:t,loading:l}=b(),[a,n]=o.exports.useState(null),r=d().id,s=o.exports.useCallback((async()=>{try{await t(`/api/link/${r}`,"GET",null,{Authorization:`Bearer ${e}`}).then((e=>{n(e)}))}catch(l){console.log(l)}}),[e,t,r]);return o.exports.useEffect((()=>{s()}),[s]),l?i.createElement(N,null):i.createElement(i.Fragment,null,!l&&a&&i.createElement(C,{link:a}))};const I=()=>{const e=o.exports.useContext(y),{loading:a,error:n,request:r,clearError:s}=b(),[m,u]=o.exports.useState({email:"",password:""}),d=o.exports.useCallback((e=>{window.M&&e&&window.M.toast({html:e})}),[]);o.exports.useEffect((()=>{d(n),s()}),[n,d,s]);const E=e=>{var a,n;u((a=c({},m),n={[e.target.name]:e.target.value},t(a,l(n))))};return i.createElement("div",{className:"auth-page"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col s6 offset-s3"},i.createElement("h1",null,"Shorten the link"),i.createElement("div",{className:"card grey lighten-5"},i.createElement("div",{className:"card-content black-text"},i.createElement("span",{className:"card-title"},"Authorization"),i.createElement("div",{className:"auth-form-fields"},i.createElement("div",{className:"input-field"},i.createElement("input",{type:"text",id:"email",name:"email",onChange:E,value:m.email}),i.createElement("label",{htmlFor:"{'email'}"},"Email")),i.createElement("div",{className:"input-field"},i.createElement("input",{type:"password",id:"password",name:"password",onChange:E,value:m.password}),i.createElement("label",{htmlFor:"{'password'}"},"Password")))),i.createElement("div",{className:"card-action buttons"},i.createElement("button",{className:"btn yellow darken-4",onClick:async()=>{try{const t=await r("/api/auth/login","POST",c({},m));e.login(t.token,t.userId)}catch(t){}},disabled:a},"Sign In"),i.createElement("button",{className:"btn teal lighten-1 ",onClick:async()=>{try{const e=await r("/api/auth/register","POST",c({},m));d(e.message)}catch(e){}},disabled:a},"Sign Up"))))))};const L=()=>{const e=u(),{logout:t}=o.exports.useContext(y);return i.createElement("nav",null,i.createElement("div",{className:"nav-wrapper header teal lighten-1"},i.createElement("span",{className:"brand-logo"},"Shorten Link"),i.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},i.createElement("li",null,i.createElement(h,{to:"/create"},"Create")),i.createElement("li",null,i.createElement(h,{to:"/links"},"Links")),i.createElement("li",null,i.createElement("a",{href:"/",onClick:l=>{l.preventDefault(),t(),e.push("/")}},"Logout")))))};function P(){const{token:e,userId:t,login:l,logout:a,ready:n}=(()=>{const[e,t]=o.exports.useState(null),[l,a]=o.exports.useState(null),[n,r]=o.exports.useState(!1),s=o.exports.useCallback(((e,l)=>{t(e),a(l),localStorage.setItem("userData",JSON.stringify({userId:l,token:e}))}),[]),c=o.exports.useCallback((()=>{t(null),a(null),localStorage.removeItem("userData")}),[]);return o.exports.useEffect((()=>{const e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&s(e.token,e.userId),r(!0)}),[s]),{login:s,logout:c,token:e,userId:l,ready:n}})(),r=!!e,s=(e=>e?i.createElement(E,null,i.createElement(p,{path:"/links",exact:!0},i.createElement(w,null)),i.createElement(p,{path:"/create",exact:!0},i.createElement(S,null)),i.createElement(p,{path:"/details/:id"},i.createElement(O,null)),i.createElement(g,{to:"/create"})):i.createElement(E,null,i.createElement(p,{path:"/",exact:!0},i.createElement(I,null)),i.createElement(g,{to:"/"})))(r);return n?i.createElement(y.Provider,{value:{token:e,userId:t,login:l,logout:a,isAuthenticated:r}},i.createElement(k,null,r&&i.createElement(L,null),i.createElement("div",{className:"container"},s))):i.createElement(N,null)}f.render(i.createElement(i.StrictMode,null,i.createElement(P,null)),document.getElementById("root"));
